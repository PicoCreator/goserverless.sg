<!DOCTYPE html>
<html lang=en>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1">
<title>Serverless professional services in Singapore</title>
<script src="https://unpkg.com/vue"></script>
<style>
body { font-family: sans-serif; margin: 0; }
main {
	margin: 1rem auto; 
	width: 80%;
	display: grid;
	grid-template-columns: repeat(2, 1fr);
	grid-column-gap: 1em;
	grid-auto-columns: fit-content(20%);
	grid-template-rows: fit-content(40%);
}
</style>
</head>
<body>
<main>
<div>
Why go serverless {{ .EmojiCountry }}?

<ol>
	<li>Reduce costs</li>
	<li>Reduce complexity</li>
	<li>Scalable</li>
	<li>Reliable</li>
</ol>

And fast iteration speeds!
</div>
<div>
<video poster="http://res.cloudinary.com/hendry/image/upload/f_auto,q_auto:eco/v1519267526/me_stj81s.jpg" width="640" height="360" controls src="https://s.natalian.org/2018-02-20/Goserverless.SG.mp4"></video>
</div>
<div id="services">
Number of AWS services in Singapore ${ count }
</div>
<div id="app">
<h3>Please get in touch</h3>
<form id="myForm" v-on:submit.prevent="submitForm">
<input required type=text name=given-name placeholder="First" autofocus>
<input required type=text name=family-name placeholder="Last">
<input required type=email name=email placeholder="email@example.com">
<input required type=text name=organization placeholder="Organisation">
<input type=text name=street-address placeholder="Street">
<input type=text name=address-level2 placeholder="City">
<input type=text name=country-name placeholder="Country">
<input type=text name=postal-code placeholder="Postal code">
<input type=tel name=tel placeholder="Telephone">
<input type=url name=url placeholder="https://example.com">
<textarea rows=5 name="notes" placeholder="Prefer a callback? Please let us know a time good for you.  Please put any relevant details about the kiosk deployment here."></textarea>
{{ .csrfField }}
<br>
<button id="button" type="submit">Send</button>
</form>
</div>
</main>

<script>
var app = new Vue({
	delimiters: ['${', '}'],
	el: '#app',
	methods: {
	submitForm: function (x) {
		fetch('/', { method: 'POST',
			headers: { "X-CSRF-Token": x.target.elements["gorilla.csrf.Token"].value },
			credentials: 'same-origin',
			body: new FormData(x.target) })
		.then(() => {
			var button = document.getElementById("button")
			button.disabled = true
			button.innerText = 'Sent!'
		})
	}
	}
})

var app = new Vue({
	delimiters: ['${', '}'],
	el: '#services',
	data: {
		count: 0
	},
	methods: {
		async goGet () {
			var response = await fetch("/ap-southeast-1");
			var json = await response.json();
			this.count = json.count
		}
	},
	created: function() {
		this.goGet()
	}
})
</script>

</body>
</html>
